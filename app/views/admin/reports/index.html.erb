<% provide :title, "Reports" %>
<% content_for :content_header do %>
  <div class="row mb-2">
    <div class="col-sm-6">
      <h1 class="m-0 text-dark">Reports</h1>
    </div>
    <div class="col-sm-6">
      <ol class="breadcrumb float-sm-right">
        <li class="breadcrumb-item">
          <%= link_to t("dashboard"), admin_dashboard_path %>
        </li>
        <li class="breadcrumb-item">
          <%= link_to "Orders list", admin_orders_path %>
        </li>
        <li class="breadcrumb-item active">Reports</li>
      </ol>
    </div>
  </div>
<% end %>

<%= form_tag report_admin_reports_path, method: :post, id: "report-form" do %>
  <div class="row mb-2">
    <div class="col-sm-8 float-left">
      <span class="btn report-btn report-btn-select" id="report-btn-day">Day</span>
      <span class="btn report-btn" id="report-btn-month">Month</span>
    </div>
    <div class="col-sm-4">
      <div class="input-group">
        <div class="input-group-prepend">
          <span class="input-group-text">
            <i class="far fa-hourglass"></i>
          </span>
        </div>
        <input type="text" name="report_date" class="form-control float-right" id="report-datepicker" readonly>
        <button type="submit" class="far fa-folder-open btn btn-success">Report</button>
      </div>
    </div>
  </div>
<% end %><hr><br>

<div class="row">
  <div class="col-12">
    <div class="card">
      <div class="card-header">
        <div class="card-tools float-left">
          Reports in <b>
          <% if @report_date %>
            <%= @report_date.strftime("%d/%m/%Y") %>
          <% elsif @report_month %>
            <%= @report_month.strftime("%m/%Y") %>
          <% else %>
            <%= DateTime.now.strftime("%d/%m/%Y") %>
          <% end %>
          </b> | <span class="badge bg-info"><%= @reports.size %></span> Orders
        </div>
        <div class="card-tools float-right">
          Total amount: <span class="badge bg-success"><%= @reports.reduce(0) {|sum, o| sum + o.total_amount} %></span>(VND)
        </div>
      </div>
      <div class="card-body table-responsive p-0">
        <table class="table table-striped table-hover table-bordered tbl-product">
          <thead>
            <tr>
              <th>#</th>
              <th><%= t "staff" %></th>
              <th><%= t "customer" %></th>
              <th>Status</th>
              <th><%= t "name" %></th>
              <th><%= t "phone" %></th>
              <th><%= t "address" %></th>
              <th>Start time</th>
              <th><%= t "person_number" %></th>
              <th>Total</th>
            </tr>
          </thead>
          <tbody>
            <% @reports.each do |report| %>
              <%= render "report", report: report %>
            <% end %>
          </tbody>
        </table>
        <div class="row paginate_row" >

        </div>
      </div>
    </div>
  </div>
</div>
